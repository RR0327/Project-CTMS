{% extends 'transport_app/base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">
        <div class="text-center mb-4">
            <h2 class="fw-bold"><i class="fas fa-user-plus me-2 text-primary"></i>Create Account</h2>
            <p class="text-white-50">Join the CTMS network today</p>
        </div>
        
        <form method="POST" class="needs-validation">
            {% csrf_token %}
            
            <div class="mb-3">
                <label class="form-label fw-bold">Full Name</label>
                <input type="text" name="name" class="form-control bg-dark text-white border-secondary" 
                       placeholder="Enter your full name" oninput="validateName(this)" required>
                <p id="name-error" class="text-danger small mt-1" style="display: none;">Name can only contain letters and spaces.</p>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label fw-bold">Email</label>
                    <input type="email" name="email" class="form-control bg-dark text-white border-secondary" 
                           placeholder="name@baiust.edu.bd" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">Role</label>
                    <select name="role" id="role" class="form-select bg-dark text-white border-secondary" 
                            onchange="toggleStudentFields()" required>
                        <option value="" disabled selected>Select your role</option>
                        <option value="student">Student</option>
                        <option value="staff">Staff</option>
                        <option value="faculty">Faculty</option>
                    </select>
                </div>
            </div>

            <div id="student-fields" class="row mb-3" style="display: none;">
                <div class="col-6">
                    <label class="form-label fw-bold">Level</label>
                    <select name="level" class="form-select bg-dark text-white border-secondary">
                        <option value="1">Level 1</option>
                        <option value="2">Level 2</option>
                        <option value="3">Level 3</option>
                        <option value="4">Level 4</option>
                    </select>
                </div>
                <div class="col-6">
                    <label class="form-label fw-bold">Term</label>
                    <select name="term" class="form-select bg-dark text-white border-secondary">
                        <option value="I">Term I</option>
                        <option value="II">Term II</option>
                    </select>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label fw-bold">ID Number</label>
                    <input type="text" name="id_number" class="form-control bg-dark text-blue border-secondary" 
                           oninput="validateIDNumber(this)" required>
                    <p id="id-number-error" class="text-danger small mt-1" style="display: none;">ID Number can only contain numbers.</p>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">Contact Number</label>
                    <input type="text" name="contact_information" class="form-control bg-dark text-white border-secondary" 
                           oninput="validateContactInfo(this)" required>
                    <p id="contact-info-error" class="text-danger small mt-1" style="display: none;">Only numeric values allowed.</p>
                </div>
            </div>

            <div class="mb-4">
                <label class="form-label fw-bold">Password</label>
                <input type="password" name="password" class="form-control bg-dark text-white border-secondary" required>
            </div>

            <button type="submit" class="btn btn-primary w-100 py-2 fw-bold rounded-pill shadow-lg">Register Now</button>
        </form>
    </div>
</div>

<script>
    // Original Registration Scripts preserved and polished
    function validateName(input) {
        const regex = /^[A-Za-z\s]*$/;
        document.getElementById("name-error").style.display = regex.test(input.value) ? "none" : "block";
    }

    function validateIDNumber(input) {
        const regex = /^\d*$/;
        document.getElementById("id-number-error").style.display = regex.test(input.value) ? "none" : "block";
    }

    function validateContactInfo(input) {
        const regex = /^\d*$/;
        document.getElementById("contact-info-error").style.display = regex.test(input.value) ? "none" : "block";
    }

    function toggleStudentFields() {
        const role = document.getElementById('role').value;
        const studentFields = document.getElementById('student-fields');
        studentFields.style.display = (role === 'student') ? 'flex' : 'none';
        
        const selects = studentFields.querySelectorAll('select');
        selects.forEach(s => role === 'student' ? s.setAttribute('required', 'true') : s.removeAttribute('required'));
    }
    document.addEventListener("DOMContentLoaded", toggleStudentFields);
</script>
{% endblock %}